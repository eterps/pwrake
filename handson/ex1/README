### Pwrake Example 1 ###

$ ls
Rakefile  nodes  regist.rb

$ ruby regist.rb 
mountpoint: /tmp/tanaka
gfreg -v -h les02.omni.hpcc.jp /tmp/temp.tanaka.32404.0 home/tanaka/handson/example1/test1.in
gfreg -v -h les03.omni.hpcc.jp /tmp/temp.tanaka.32404.1 home/tanaka/handson/example1/test2.in
gfreg -v -h les04.omni.hpcc.jp /tmp/temp.tanaka.32404.2 home/tanaka/handson/example1/test3.in
gfreg -v -h les05.omni.hpcc.jp /tmp/temp.tanaka.32404.3 home/tanaka/handson/example1/test4.in
gfreg -v -h les02.omni.hpcc.jp /tmp/temp.tanaka.32404.4 home/tanaka/handson/example1/test5.in
gfreg -v -h les03.omni.hpcc.jp /tmp/temp.tanaka.32404.5 home/tanaka/handson/example1/test6.in
gfreg -v -h les04.omni.hpcc.jp /tmp/temp.tanaka.32404.6 home/tanaka/handson/example1/test7.in
gfreg -v -h les05.omni.hpcc.jp /tmp/temp.tanaka.32404.7 home/tanaka/handson/example1/test8.in
gfreg -v -h les02.omni.hpcc.jp /tmp/temp.tanaka.32404.8 home/tanaka/handson/example1/test9.in
gfreg -v -h les03.omni.hpcc.jp /tmp/temp.tanaka.32404.9 home/tanaka/handson/example1/test10.in

$ pwrake FS=gfarm NODEFILE=nodes 
(in /tmp/tanaka/home/tanaka/handson/example1)
LogStart=2010-06-30T20:50:26.448607
HOSTS=
les02.omni.hpcc.jp
les03.omni.hpcc.jp
les04.omni.hpcc.jp
les05.omni.hpcc.jp
FILESYSTEM=Gfarm
MOUNTPOINT=
  PID TTY      STAT   TIME COMMAND
 3054 ?        S      0:00 sshd: tanaka@pts/6
 3055 pts/6    Ss+    0:00 -bash
 3093 ?        Ss     0:00 ssh-agent
 6536 ?        S      0:00 sshd: tanaka@pts/8
 6537 pts/8    Ss     0:00 -bash
 6576 ?        Ss     0:00 ssh-agent
 7809 ?        Ss     0:00 ssh-agent
 8312 ?        Ss     0:13 gfarm2fs /tmp/tanaka/
11966 ?        Ss     0:00 ssh-agent
12714 ?        Ss     0:00 ssh-agent
12768 ?        Ss     0:00 ssh-agent
19120 ?        S      0:00 sshd: tanaka@notty
19121 ?        Ss     0:00 /usr/libexec/openssh/sftp-server
19696 ?        S      0:00 sshd: tanaka@pts/4
19697 pts/4    Ss+    0:00 -bash
19736 ?        Ss     0:00 ssh-agent
25149 ?        S      0:00 sshd: tanaka@pts/5
25150 pts/5    Ss+    0:00 -bash
25189 ?        Ss     0:00 ssh-agent
31909 ?        S      0:03 sshd: tanaka@pts/0
31910 pts/0    Ss+    0:00 -bash
31949 ?        Ss     0:00 ssh-agent
32416 pts/8    Sl+    0:00 /usr/bin/ruby /usr/bin/pwrake FS=gfarm NODEFILE=nodes
32418 pts/8    S+     0:00 ssh -x -T -q les02.omni.hpcc.jp
32419 pts/8    S+     0:00 ssh -x -T -q les03.omni.hpcc.jp
32420 pts/8    S+     0:00 ssh -x -T -q les04.omni.hpcc.jp
32421 pts/8    S+     0:00 ssh -x -T -q les05.omni.hpcc.jp
32422 pts/8    R+     0:00 ps x
prepare SSH : start=2010-06-30T20:50:26.450370 end=2010-06-30T20:50:26.958813 elap=0.508443
result.size=10
multitask_ssh(default)[gfwhere] : start=2010-06-30T20:50:26.959161 end=2010-06-30T20:50:27.028426 elap=0.069265
multitask_ssh(default)[prepare] : start=2010-06-30T20:50:26.959161 end=2010-06-30T20:50:27.032189 elap=0.0730280000000001
** Affinity for test1.in: gfwhere=["les02.omni.hpcc.jp"] == ssh.host=les02.omni.hpcc.jp
** Affinity for test3.in: gfwhere=["les04.omni.hpcc.jp"] == ssh.host=les04.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test1.in`
    ) > test1.out
pw_rsh[start]: name=test1.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test1.in`
    ) > test1.out",end=1277898627.035
** Affinity for test4.in: gfwhere=["les05.omni.hpcc.jp"] == ssh.host=les05.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test3.in`
    ) > test3.out
pw_rsh[start]: name=test3.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test3.in`
    ) > test3.out",end=1277898627.036
** Affinity for test10.in: gfwhere=["les03.omni.hpcc.jp"] == ssh.host=les03.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test4.in`
    ) > test4.out
pw_rsh[start]: name=test4.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test4.in`
    ) > test4.out",end=1277898627.038
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test10.in`
    ) > test10.out
pw_rsh[start]: name=test10.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test10.in`
    ) > test10.out",end=1277898627.039
pw_rsh[end]: name=test1.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test1.in`
    ) > test1.out",end=1277898627.332,elap=0.297
node=[les02.omni.hpcc.jp] input=[test1.in] output=[test1.out] dag=yet weight=0
** Affinity for test5.in: gfwhere=["les02.omni.hpcc.jp"] == ssh.host=les02.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test5.in`
    ) > test5.out
pw_rsh[start]: name=test5.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test5.in`
    ) > test5.out",end=1277898627.333
pw_rsh[end]: name=test4.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test4.in`
    ) > test4.out",end=1277898627.343,elap=0.305
node=[les05.omni.hpcc.jp] input=[test4.in] output=[test4.out] dag=yet weight=0
** Affinity for test8.in: gfwhere=["les05.omni.hpcc.jp"] == ssh.host=les05.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test8.in`
    ) > test8.out
pw_rsh[start]: name=test8.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test8.in`
    ) > test8.out",end=1277898627.344
pw_rsh[end]: name=test10.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test10.in`
    ) > test10.out",end=1277898627.353,elap=0.315
node=[les03.omni.hpcc.jp] input=[test10.in] output=[test10.out] dag=yet weight=0
** Affinity for test2.in: gfwhere=["les03.omni.hpcc.jp"] == ssh.host=les03.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test2.in`
    ) > test2.out
pw_rsh[start]: name=test2.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test2.in`
    ) > test2.out",end=1277898627.355
pw_rsh[end]: name=test3.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test3.in`
    ) > test3.out",end=1277898627.364,elap=0.328
node=[les04.omni.hpcc.jp] input=[test3.in] output=[test3.out] dag=yet weight=0
** Affinity for test7.in: gfwhere=["les04.omni.hpcc.jp"] == ssh.host=les04.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test7.in`
    ) > test7.out
pw_rsh[start]: name=test7.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test7.in`
    ) > test7.out",end=1277898627.365
pw_rsh[end]: name=test5.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test5.in`
    ) > test5.out",end=1277898627.531,elap=0.199
node=[les02.omni.hpcc.jp] input=[test5.in] output=[test5.out] dag=yet weight=0
** Affinity for test9.in: gfwhere=["les02.omni.hpcc.jp"] == ssh.host=les02.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test9.in`
    ) > test9.out
pw_rsh[start]: name=test9.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test9.in`
    ) > test9.out",end=1277898627.533
pw_rsh[end]: name=test8.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test8.in`
    ) > test8.out",end=1277898627.542,elap=0.199
node=[les05.omni.hpcc.jp] input=[test8.in] output=[test8.out] dag=yet weight=0
** Affinity for test6.in: gfwhere=["les03.omni.hpcc.jp"] != ssh.host=les05.omni.hpcc.jp
(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test6.in`
    ) > test6.out
pw_rsh[start]: name=test6.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test6.in`
    ) > test6.out",end=1277898627.543
pw_rsh[end]: name=test7.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test7.in`
    ) > test7.out",end=1277898627.553,elap=0.187
node=[les04.omni.hpcc.jp] input=[test7.in] output=[test7.out] dag=yet weight=0
pw_rsh[end]: name=test2.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test2.in`
    ) > test2.out",end=1277898627.564,elap=0.209
node=[les03.omni.hpcc.jp] input=[test2.in] output=[test2.out] dag=yet weight=0
pw_rsh[end]: name=test9.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test9.in`
    ) > test9.out",end=1277898627.653,elap=0.120
node=[les02.omni.hpcc.jp] input=[test9.in] output=[test9.out] dag=yet weight=0
pw_rsh[end]: name=test6.out,cmd="(
    echo 'hostname: '`hostname`
    echo 'pwd:      '`pwd`
    echo 'gfwhere:  '`gfwhere /home/tanaka/handson/example1/test6.in`
    ) > test6.out",end=1277898627.663,elap=0.120
node=[les05.omni.hpcc.jp] input=[test6.in] output=[test6.out] dag=yet weight=0
multitask_ssh(default)[end] : start=2010-06-30T20:50:26.959161 end=2010-06-30T20:50:27.663332 elap=0.704171
finish pwrake
same=9, diff=1, total=10
same_hosts = {
  les02.omni.hpcc.jp: 3
  les03.omni.hpcc.jp: 2
  les04.omni.hpcc.jp: 2
  les05.omni.hpcc.jp: 2
}
different_hosts = {
  les05.omni.hpcc.jp: 1
}
LogEnd : start=2010-06-30T20:50:26.448607 end=2010-06-30T20:50:27.874910 elap=1.426303

$ tail *.out
==> test1.out <==
hostname: les02.omni.hpcc.jp
pwd:      /tmp/tanaka000/home/tanaka/handson/example1
gfwhere:  les02.omni.hpcc.jp

==> test10.out <==
hostname: les03.omni.hpcc.jp
pwd:      /tmp/tanaka001/home/tanaka/handson/example1
gfwhere:  les03.omni.hpcc.jp

==> test2.out <==
hostname: les03.omni.hpcc.jp
pwd:      /tmp/tanaka001/home/tanaka/handson/example1
gfwhere:  les03.omni.hpcc.jp

==> test3.out <==
hostname: les04.omni.hpcc.jp
pwd:      /tmp/tanaka002/home/tanaka/handson/example1
gfwhere:  les04.omni.hpcc.jp

==> test4.out <==
hostname: les05.omni.hpcc.jp
pwd:      /tmp/tanaka003/home/tanaka/handson/example1
gfwhere:  les05.omni.hpcc.jp

==> test5.out <==
hostname: les02.omni.hpcc.jp
pwd:      /tmp/tanaka000/home/tanaka/handson/example1
gfwhere:  les02.omni.hpcc.jp

==> test6.out <==
hostname: les05.omni.hpcc.jp
pwd:      /tmp/tanaka003/home/tanaka/handson/example1
gfwhere:  les03.omni.hpcc.jp

==> test7.out <==
hostname: les04.omni.hpcc.jp
pwd:      /tmp/tanaka002/home/tanaka/handson/example1
gfwhere:  les04.omni.hpcc.jp

==> test8.out <==
hostname: les05.omni.hpcc.jp
pwd:      /tmp/tanaka003/home/tanaka/handson/example1
gfwhere:  les05.omni.hpcc.jp

==> test9.out <==
hostname: les02.omni.hpcc.jp
pwd:      /tmp/tanaka000/home/tanaka/handson/example1
gfwhere:  les02.omni.hpcc.jp
